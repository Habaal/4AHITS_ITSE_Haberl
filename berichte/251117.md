# Portscan — Arbeitsbericht

**Klasse:** 4 AHITS
**Name:** Martin Haberl
**Fach:** ITSE4 – Übungen
**Datum:** 03.11.2025

---

# Analyse des nmap-Scans

## 1) Ziel der Übung

In dieser Übung soll ein erweitertes nmap-Scanning durchgeführt werden. Ziel ist, besser zu verstehen:

* welche Arten von Scans nmap kombiniert,
* welche Informationen dabei gesammelt werden,
* wie viele Ports durchsucht werden,
* und wie man die Ergebnisse dokumentiert.

Der Scan erfolgt mit einer Kombination aus Host-Discovery-Bypass, Versions-Scan, Script-Scan und SYN-Scanning.

Das zu untersuchende Kommando lautet:

```sh
nmap -Pn -sS -sV -sC -oN nmap_default.txt 10.10.92.153
```

Als Ziel dient wie gewohnt die Metasploitable-VM im Labor.

---

## 2) Bedeutung der Optionen

### -Pn

Deaktiviert die Host-Discovery. Nmap führt keinen Ping-Check durch und behandelt das Ziel immer als online.

Warum sinnvoll?

* Manche Systeme blockieren ICMP.
* Der Scan wird trotzdem durchgeführt.

---

### -sS

Führt einen SYN-Scan durch (Half-Open Scan).

Eigenschaften:

* schnell,
* zuverlässig,
* unauffälliger als ein vollständiger TCP-Connect-Scan.

---

### -sV

Aktiviert die Service- und Versionsbestimmung. Nmap versucht für jeden offenen Port herauszufinden:

* welcher Dienst läuft,
* welche Version,
* zusätzliche Hinweise wie OS oder Libraries.

---

### -sC

Führt die Default NSE Scripts aus. Diese Scripts sammeln zusätzliche Informationen wie:

* Banner/Versionen
* Webserver-Infos
* RPC/SMB-Abfragen
* einfache Verwundbarkeitschecks

---

### -oN nmap_default.txt

Speichert die gesamte Ausgabe im normalen Textformat in die Datei:

`nmap_default.txt`

---

### Standard-Portbereich

Da kein Portbereich definiert ist, scannt nmap automatisch:

**→ die 1000 am häufigsten verwendeten TCP-Ports**

Es werden nicht alle 65535 Ports untersucht.

---

# 3) Ausführung des Scans auf der Metasploitable-VM

Beispielausführung:

```sh
nmap -Pn -sS -sV -sC -oN nmap_default.txt 192.168.5.51
```

### Ausgabe:

```sh
┌──(kali㉿kali)-[~]
└─$ nmap -Pn -sS -sV -sC -oN nmap_default.txt 192.168.5.51
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:03 EST
Nmap scan report for 192.168.5.51
Host is up (0.0015s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE     VERSION
21/tcp   open  ftp         vsftpd 2.3.4
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.5.52
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
22/tcp   open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
23/tcp   open  telnet      Linux telnetd
25/tcp   open  smtp        Postfix smtpd
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
|_ssl-date: 2025-11-17T11:04:20+00:00; +3s from scanner time.
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
|     SSL2_RC4_128_WITH_MD5
|     SSL2_DES_192_EDE3_CBC_WITH_MD5
|     SSL2_DES_64_CBC_WITH_MD5
|     SSL2_RC2_128_CBC_WITH_MD5
|_    SSL2_RC4_128_EXPORT40_WITH_MD5
|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
53/tcp   open  domain      ISC BIND 9.4.2
| dns-nsid: 
|_  bind.version: 9.4.2
80/tcp   open  http        Apache httpd 2.2.8 ((Ubuntu) DAV/2)
|_http-server-header: Apache/2.2.8 (Ubuntu) DAV/2
|_http-title: Metasploitable2 - Linux
111/tcp  open  rpcbind     2 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      39694/tcp   mountd
|   100005  1,2,3      41212/udp   mountd
|   100021  1,3,4      47210/tcp   nlockmgr
|   100021  1,3,4      60951/udp   nlockmgr
|   100024  1          35913/tcp   status
|_  100024  1          57609/udp   status
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)
512/tcp  open  exec        netkit-rsh rexecd
513/tcp  open  login       OpenBSD or Solaris rlogind
514/tcp  open  tcpwrapped
1099/tcp open  java-rmi    GNU Classpath grmiregistry
1524/tcp open  bindshell   Metasploitable root shell
2049/tcp open  nfs         2-4 (RPC #100003)
2121/tcp open  ftp         ProFTPD 1.3.1
3306/tcp open  mysql       MySQL 5.0.51a-3ubuntu5
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 9
|   Capabilities flags: 43564
|   Some Capabilities: LongColumnFlag, Support41Auth, Speaks41ProtocolNew, SwitchToSSLAfterHandshake, SupportsTransactions, SupportsCompression, ConnectWithDatabase
|   Status: Autocommit
|_  Salt: Kng:-qpauJN,.@:@p7`_
5432/tcp open  postgresql  PostgreSQL DB 8.3.0 - 8.3.7
|_ssl-date: 2025-11-17T11:04:20+00:00; +3s from scanner time.
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
5900/tcp open  vnc         VNC (protocol 3.3)
| vnc-info: 
|   Protocol version: 3.3
|   Security types: 
|_    VNC Authentication (2)
6000/tcp open  X11         (access denied)
6667/tcp open  irc         UnrealIRCd
| irc-info: 
|   users: 1
|   servers: 1
|   lusers: 1
|   lservers: 0
|   server: irc.Metasploitable.LAN
|   version: Unreal3.2.8.1. irc.Metasploitable.LAN 
|   uptime: 0 days, 0:08:23
|   source ident: nmap
|   source host: EB029067.DE97E244.FFFA6D49.IP
|_  error: Closing Link: deulugwiv[192.168.5.52] (Quit: deulugwiv)
8009/tcp open  ajp13       Apache Jserv (Protocol v1.3)
|_ajp-methods: Failed to get a valid response for the OPTION request
8180/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1
|_http-favicon: Apache Tomcat
|_http-server-header: Apache-Coyote/1.1
|_http-title: Apache Tomcat/5.5
MAC Address: 00:0C:29:26:B9:F5 (VMware)
Service Info: Hosts:  metasploitable.localdomain, irc.Metasploitable.LAN; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
|_clock-skew: mean: 1h15m02s, deviation: 2h29m59s, median: 2s
| smb-security-mode: 
|   account_used: <blank>
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2025-11-17T06:04:10-05:00
|_smb2-time: Protocol negotiation failed (SMB2)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 20.40 seconds

```

### Interpretation

* Viele klassische Metasploitable2-Dienste erscheinen.
* Versionen wie Apache 2.2.8, MySQL 5.0.51a oder OpenSSH 4.7p1 werden korrekt erkannt.
* Default-Scripts liefern zusätzliche Informationen (SMB, HTTP, RPC etc.).

---
# Übung (vulnerability scan)
## Ziel der Übung

In dieser Übung soll die Nutzung der nmap Scripting Engine (NSE) zur Durchführung von Schwachstellenanalysen untersucht werden. Nmap bietet die Möglichkeit, mit Hilfe von Lua-Skripten automatisch viele Informationen über die Zielsysteme zu sammeln. Diese Skripte befinden sich im Verzeichnis:

```sh
/usr/share/nmap/scripts
```

Ziel ist es, mit verschiedenen nmap-Optionen Schwachstellen und Konfigurationsprobleme auf der Metasploitable VM zu identifizieren.


## Aufgabe 1: Scan mit Standard-Skripten (-sC) und den Top 100 Ports (-F)

Befehl:

```sh
nmap -sC -F 192.168.5.51
```

Erklärung der Optionen:

-sC: Führt die Standard-Skripte von nmap aus, die nützliche Informationen wie Banner und Dienstdetails abfragen.

-F: Beschränkt den Scan auf die 100 am häufigsten verwendeten Ports (Fast Scan).

Erwartete Ausgabe:
Die Standard-Skripte werden ausgeführt, um grundlegende Informationen zu sammeln. Beispiele von Skripten, die ausgeführt werden, sind:

``http-title`` (gibt den Titel der Webseite zurück),

`` banner`` (zeigt den Banner eines Dienstes).

Ausgabe:
```sh
┌──(kali㉿kali)-[~]
└─$ nmap -sC -F 192.168.5.51
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:48 EST
Nmap scan report for 192.168.5.51
Host is up (0.0022s latency).
Not shown: 82 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.5.52
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
22/tcp   open  ssh
| ssh-hostkey: 
|   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)
|_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)
23/tcp   open  telnet
25/tcp   open  smtp
|_ssl-date: 2025-11-17T11:48:53+00:00; +3s from scanner time.
| sslv2: 
|   SSLv2 supported
|   ciphers: 
|     SSL2_DES_192_EDE3_CBC_WITH_MD5
|     SSL2_RC4_128_EXPORT40_WITH_MD5
|     SSL2_RC2_128_CBC_WITH_MD5
|     SSL2_RC2_128_CBC_EXPORT40_WITH_MD5
|     SSL2_RC4_128_WITH_MD5
|_    SSL2_DES_64_CBC_WITH_MD5
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
|_smtp-commands: metasploitable.localdomain, PIPELINING, SIZE 10240000, VRFY, ETRN, STARTTLS, ENHANCEDSTATUSCODES, 8BITMIME, DSN
53/tcp   open  domain
| dns-nsid: 
|_  bind.version: 9.4.2
80/tcp   open  http
|_http-title: Metasploitable2 - Linux
111/tcp  open  rpcbind
| rpcinfo: 
|   program version    port/proto  service
|   100000  2            111/tcp   rpcbind
|   100000  2            111/udp   rpcbind
|   100003  2,3,4       2049/tcp   nfs
|   100003  2,3,4       2049/udp   nfs
|   100005  1,2,3      39694/tcp   mountd
|   100005  1,2,3      41212/udp   mountd
|   100021  1,3,4      47210/tcp   nlockmgr
|   100021  1,3,4      60951/udp   nlockmgr
|   100024  1          35913/tcp   status
|_  100024  1          57609/udp   status
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
513/tcp  open  login
514/tcp  open  shell
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 17
|   Capabilities flags: 43564
|   Some Capabilities: ConnectWithDatabase, LongColumnFlag, SupportsCompression, Speaks41ProtocolNew, Support41Auth, SwitchToSSLAfterHandshake, SupportsTransactions
|   Status: Autocommit
|_  Salt: Nz>aRT16[J?>Vwt`bN?1
5432/tcp open  postgresql
|_ssl-date: 2025-11-17T11:48:37+00:00; +5s from scanner time.
| ssl-cert: Subject: commonName=ubuntu804-base.localdomain/organizationName=OCOSA/stateOrProvinceName=There is no such thing outside US/countryName=XX
| Not valid before: 2010-03-17T14:07:45
|_Not valid after:  2010-04-16T14:07:45
5900/tcp open  vnc
| vnc-info: 
|   Protocol version: 3.3
|   Security types: 
|_    VNC Authentication (2)
6000/tcp open  X11
8009/tcp open  ajp13
|_ajp-methods: Failed to get a valid response for the OPTION request
MAC Address: 00:0C:29:26:B9:F5 (VMware)

Host script results:
|_smb2-time: Protocol negotiation failed (SMB2)
|_clock-skew: mean: 1h15m04s, deviation: 2h30m00s, median: 4s
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2025-11-17T06:48:35-05:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_nbstat: NetBIOS name: METASPLOITABLE, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)

Nmap done: 1 IP address (1 host up) scanned in 49.41 seconds

```

Interpretation:
Mit den Standard-Skripten wurden grundlegende Dienst- und Versionsinformationen wie der HTTP-Titel oder der SSH-Dienst aufgedeckt.

## Aufgabe 2: Verwenden von benutzerdefinierten Skripten mit der Option --script

Befehl:

```sh
nmap --script http-title,mysql-info,banner,ftp-anon,smb-os-discovery 192.168.5.51
```

Erklärung der Skripte:

``http-title``: Liest den HTML-Titel einer Webseite.

``mysql-info``: Gibt MySQL-Version und -Konfiguration zurück.

``banner``: Führt ein einfaches Banner-Grabbing durch.

``ftp-anon``: Überprüft, ob anonymer FTP-Zugang erlaubt ist.

``smb-os-discovery``: Ermittelt die Samba-Version und das zugrundeliegende Betriebssystem.

Ausgabe:
```sh
┌──(kali㉿kali)-[~]
└─$ nmap --script http-title,mysql-info,banner,ftp-anon,smb-os-discovery 192.168.5.51
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:49 EST
Nmap scan report for 192.168.5.51
Host is up (0.0022s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
|_banner: 220 (vsFTPd 2.3.4)
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
22/tcp   open  ssh
|_banner: SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1
23/tcp   open  telnet
|_banner: \xFF\xFD\x18\xFF\xFD \xFF\xFD#\xFF\xFD'
25/tcp   open  smtp
|_banner: 220 metasploitable.localdomain ESMTP Postfix (Ubuntu)
53/tcp   open  domain
80/tcp   open  http
|_http-title: Metasploitable2 - Linux
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
|_banner: \x01Where are you?
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
|_banner: root@metasploitable:/#
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
|_banner: 220 ProFTPD 1.3.1 Server (Debian) [::ffff:192.168.5.51]
3306/tcp open  mysql
| mysql-info: 
|   Protocol: 10
|   Version: 5.0.51a-3ubuntu5
|   Thread ID: 26
|   Capabilities flags: 43564
|   Some Capabilities: Support41Auth, SupportsCompression, SwitchToSSLAfterHandshake, ConnectWithDatabase, Speaks41ProtocolNew, SupportsTransactions, LongColumnFlag
|   Status: Autocommit
|_  Salt: ONy;V}4+zE*AH%|d_2y-
| banner: >\x00\x00\x00\x0A5.0.51a-3ubuntu5\x00\x1B\x00\x00\x002IYenx0&\x
|_00,\xAA\x08\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\...
5432/tcp open  postgresql
5900/tcp open  vnc
|_banner: RFB 003.003
6000/tcp open  X11
6667/tcp open  irc
| banner: :irc.Metasploitable.LAN NOTICE AUTH :*** Looking up your hostna
|_me...\x0D\x0A:irc.Metasploitable.LAN NOTICE AUTH :*** Couldn't resol...
8009/tcp open  ajp13
8180/tcp open  unknown
|_http-title: Apache Tomcat/5.5
MAC Address: 00:0C:29:26:B9:F5 (VMware)

Host script results:
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2025-11-17T06:49:49-05:00

Nmap done: 1 IP address (1 host up) scanned in 16.07 seconds
```

Interpretation:
Mehrere wichtige Informationen wurden durch benutzerdefinierte Skripte abgerufen, z. B. die MySQL-Version und ein offenes FTP mit anonymem Zugang.

## Aufgabe 3: Finden eines weiteren sinnvollen Skripts für die Metasploitable VM

Ein weiteres nützliches Skript für Metasploitable ist:

``http-enum``

Befehl:
```sh
nmap --script http-enum -p80 192.168.5.51
```

Nutzen des Skripts:
Das Skript scannt nach interessanten Web-Verzeichnissen und -Anwendungen. Auf der Metasploitable-VM werden häufig folgende Anwendungen gefunden:
```sh
/phpMyAdmin/

/mutillidae/

/dvwa/

/twiki/

/dav/
```
Ausgabe:
```sh
┌──(kali㉿kali)-[~]
└─$ nmap --script http-enum -p80 192.168.5.51
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 06:52 EST
Nmap scan report for 192.168.5.51
Host is up (0.00056s latency).

PORT   STATE SERVICE
80/tcp open  http
| http-enum: 
|   /tikiwiki/: Tikiwiki
|   /test/: Test page
|   /phpinfo.php: Possible information file
|   /phpMyAdmin/: phpMyAdmin
|   /doc/: Potentially interesting directory w/ listing on 'apache/2.2.8 (ubuntu) dav/2'
|   /icons/: Potentially interesting folder w/ directory listing
|_  /index/: Potentially interesting folder
MAC Address: 00:0C:29:26:B9:F5 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.94 seconds

```

Interpretation:
Durch das Skript werden potenziell interessante Webanwendungen identifiziert, die weiter untersucht werden können.

## Aufgabe 4: Starten aller Skripte der Kategorie vuln

Die nmap-Skripte sind in Kategorien eingeteilt. Eine dieser Kategorien ist vuln, die speziell auf die Identifikation von Schwachstellen ausgelegt ist.

Befehl:
```sh
nmap --script=vuln -p 21 -v 192.168.5.51
```

Ausgabe:
```sh
┌──(kali㉿kali)-[~]
└─$ nmap --script=vuln -p 21 -v 192.168.5.51
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 07:01 EST
NSE: Loaded 105 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 07:01
Stats: 0:00:07 elapsed; 0 hosts completed (0 up), 0 undergoing Script Pre-Scan
NSE: Active NSE Script Threads: 1 (1 waiting)
NSE Timing: About 0.00% done
Completed NSE at 07:02, 10.01s elapsed
Initiating NSE at 07:02
Completed NSE at 07:02, 0.00s elapsed
Initiating ARP Ping Scan at 07:02
Scanning 192.168.5.51 [1 port]
Completed ARP Ping Scan at 07:02, 0.05s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 07:02
Completed Parallel DNS resolution of 1 host. at 07:02, 0.01s elapsed
Initiating SYN Stealth Scan at 07:02
Scanning 192.168.5.51 [1 port]
Discovered open port 21/tcp on 192.168.5.51
Completed SYN Stealth Scan at 07:02, 0.03s elapsed (1 total ports)
NSE: Script scanning 192.168.5.51.
Initiating NSE at 07:02
Completed NSE at 07:02, 1.02s elapsed
Initiating NSE at 07:02
Completed NSE at 07:02, 0.00s elapsed
Nmap scan report for 192.168.5.51
Host is up (0.0020s latency).

PORT   STATE SERVICE
21/tcp open  ftp
| ftp-vsftpd-backdoor: 
|   VULNERABLE:
|   vsFTPd version 2.3.4 backdoor
|     State: VULNERABLE (Exploitable)
|     IDs:  BID:48539  CVE:CVE-2011-2523
|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
|     Disclosure date: 2011-07-03
|     Exploit results:
|       Shell command: id
|       Results: uid=0(root) gid=0(root)
|     References:
|       http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523
|       https://www.securityfocus.com/bid/48539
|_      https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb
MAC Address: 00:0C:29:26:B9:F5 (VMware)

NSE: Script Post-scanning.
Initiating NSE at 07:02
Completed NSE at 07:02, 0.00s elapsed
Initiating NSE at 07:02
Completed NSE at 07:02, 0.00s elapsed
Read data files from: /usr/share/nmap
Nmap done: 1 IP address (1 host up) scanned in 11.33 seconds
           Raw packets sent: 2 (72B) | Rcvd: 2 (72B)
```

wenn man ``-p 12,80`` scannt, findet er diverse Websites die am Metasploitable laufen und schlägt mögliche angriffsmöglichkeiten vor wie z.B.: eine SQL Injection:

```sh
Possible sqli for forms:
|     Form at path: /mutillidae/index.php, form's action: index.php. Fields that might be vulnerable:
|       choice
|       choice
|       choice
|       choice
|       choice
|       choice
|       choice
|       choice
|       choice
|       choice
|       choice
|       choice
|_      initials
```

---


# Übung (very safe FTP backdoor)

##  Ziel der Übung

In dieser Übung soll der nmap-Scan auf den FTP-Port 21 (Metasploitable VM) eingegrenzt werden, um eine spezifische Schwachstelle (den "Very Safe FTP Backdoor") zu identifizieren. Die Aufgabe besteht darin, den nmap Vulnerability Scan auf diesen Port zu beschränken und die CVE-Nummer zu untersuchen, die auf eine bekannte Sicherheitslücke hinweist.

---

## Aufgabe: Einschränkung des nmap vuln-Scans auf Port 21/FTP

Befehl:

```sh
nmap --script=vuln -p 21 192.168.5.51
```

Erklärung der Optionen:

* `--script=vuln`: Führt nur die nmap-Skripte aus, die auf Schwachstellen (vuln) ausgelegt sind.
* `-p 21`: Beschränkt den Scan auf den FTP-Port (Port 21).
* `192.168.5.51`: Ziel-IP der Metasploitable-VM.

Erwartetes Ergebnis:
Der Scan auf Port 21 sollte ein nmap-Skript zur Schwachstellenprüfung auslösen und Informationen zu möglichen Sicherheitslücken anzeigen, wie z. B. eine Schwachstelle im FTP-Dienst, die in Form einer CVE-Nummer präsentiert wird.

Beispielausgabe:

```
┌──(kali㉿kali)-[~]
└─$ nmap --script=vuln -p 21 192.168.5.51
Starting Nmap 7.95 ( https://nmap.org ) at 2025-11-17 07:17 EST
Nmap scan report for 192.168.5.51
Host is up (0.00072s latency).

PORT   STATE SERVICE
21/tcp open  ftp
| ftp-vsftpd-backdoor: 
|   VULNERABLE:
|   vsFTPd version 2.3.4 backdoor
|     State: VULNERABLE (Exploitable)
|     IDs:  CVE:CVE-2011-2523  BID:48539
|       vsFTPd version 2.3.4 backdoor, this was reported on 2011-07-04.
|     Disclosure date: 2011-07-03
|     Exploit results:
|       Shell command: id
|       Results: uid=0(root) gid=0(root)
|     References:
|       https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/unix/ftp/vsftpd_234_backdoor.rb
|       https://www.securityfocus.com/bid/48539
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523
|_      http://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html
MAC Address: 00:0C:29:26:B9:F5 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 11.33 seconds
                                                              
```

Interpretation:
Das Skript zeigt, dass der FTP-Dienst (vsftpd 2.3.4) auf der Metasploitable-VM eine bekannte Schwachstelle aufweist, die es einem Angreifer ermöglichen könnte, Root-Zugriff auf das System zu erlangen.

---

##  Weitere Untersuchung der Schwachstelle (CVE-2011-2523)

Die angezeigte CVE-Nummer `CVE-2011-2523` beschreibt eine Schwachstelle in der vsftpd-Version 2.3.4, die es Angreifern ermöglicht, über eine Backdoor-Option im FTP-Dienst Zugriff auf das System zu erlangen.

CVE-Details

* **CVE-Nummer:** CVE-2011-2523
* **Beschreibung:** Die Schwachstelle betrifft die vsftpd-Softwareversion 2.3.4, die eine Backdoor-Funktion enthält. Ein Angreifer kann über den FTP-Dienst als root in das System eindringen, indem er einen speziellen Benutzername `:)` verwendet, der auf einen Shell-Prompt zugreift. Diese Schwachstelle wurde absichtlich in der Software eingebaut, um Penetrationstestern zu helfen, aber sie stellt eine erhebliche Sicherheitslücke dar.
* **Veröffentlichungsdatum:** 2011
* **Schwierigkeitsgrad der Ausnutzung:** Diese Schwachstelle kann ohne Authentifizierung ausgenutzt werden, was sie besonders gefährlich macht.

Weitere Ressourcen:

* [CVE-2011-2523 auf cve.mitre.org](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2523)
* [Weitere Informationen zu VSFTPD](https://www.exploit-db.com/exploits/17487)

