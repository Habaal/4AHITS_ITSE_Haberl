# Übung Vulnerability Scanning

**Klasse:** 4 AHITS
**Name:** Martin Haberl
**Fach:** ITSE4 – Übungen
**Datum:** 03.11.2025

---

## 1) Ziel der Übung

Ziel dieser Übung ist es, den Dienst **rlogin** zu untersuchen und die in der Aufgabenstellung genannten Fragestellungen systematisch zu beantworten. Dabei wird auf der Metasploitable-VM überprüft, ob der rlogin-Dienst erreichbar ist, ob ein Root-Login möglich ist, welche Fehlkonfiguration dies erlaubt und wie diese Sicherheitslücke geschlossen werden kann.

---

## 2) Informiere dich über rlogin und mögliche Angriffe / Fehlkonfigurationen

`rlogin` (Remote Login) ist ein veralteter UNIX-Dienst aus der BSD-Familie, der eine Anmeldung auf entfernten Systemen ermöglicht.

Typische Sicherheitsprobleme von rlogin:

* Die Verbindung ist **nicht verschlüsselt** (Klartextübertragung).
* Die Authentifizierung basiert auf **Vertrauen in den Host**, nicht auf sicheren Zugangsdaten.
* Verwendung von Vertrauensdateien wie:

  * `/etc/hosts.equiv`
  * `~/.rhosts`
* Ein Angreifer kann diese Vertrauensmechanismen ausnutzen.

Mögliche Angriffe:

* Passwortloser Login
* IP-Spoofing / Missbrauch von Trusted Hosts
* Direkter Root-Zugriff

---

## 3) Prüfen mit nmap, ob der rlogin-Port bei Metasploitable offen ist

Der rlogin-Dienst verwendet standardmäßig **TCP-Port 513**.

### Scan-Befehl:

```sh
nmap -p 513 192.168.5.51
```

### Ausgabe:

```sh
PORT    STATE SERVICE
513/tcp open  login
```

### Interpretation:

Der Scan zeigt, dass der rlogin-Dienst aktiv ist und der zugehörige Port 513 offen ist. Damit ist eine Anmeldung über rlogin grundsätzlich möglich.

---

## 4) Nutzung der Sicherheitslücke: Login als root mit rlogin

Da der rlogin-Dienst aktiv ist, wird versucht, sich als **root** anzumelden.

### Befehl:

```sh
rlogin 192.168.5.51 -l root
```

### Ergebnis:

```sh
Last login: Tue Nov  3 08:21:17 from 192.168.5.52
root@metasploitable:/#
```

### Interpretation:

Der Login als root funktioniert ohne Passwortabfrage. Dadurch erhält man sofort vollständige Administratorrechte auf dem System.

---

## 5) Welche Fehlkonfiguration ermöglicht diesen Exploit?

Der Exploit wird durch mehrere Fehlkonfigurationen ermöglicht:

* Der veraltete rlogin-Dienst ist aktiviert.
* Root-Logins über rlogin sind erlaubt.
* Die Authentifizierung basiert auf Vertrauensbeziehungen statt auf Passwörtern.
* Vertrauensdateien wie `/etc/hosts.equiv` oder `/root/.rhosts` sind vorhanden oder unsicher konfiguriert.

Diese Konfiguration erlaubt es, sich ohne Authentifizierung als root anzumelden.

---

## 6) Änderung der Konfiguration zur Schließung der Sicherheitslücke

Um die Sicherheitslücke zu schließen, müssen folgende Maßnahmen umgesetzt werden:

* Deaktivieren oder Entfernen des rlogin-Dienstes.
* Löschen oder Leeren der Datei `/etc/hosts.equiv`.
* Entfernen aller `.rhosts`-Dateien.
* Verhindern von Root-Logins über das Netzwerk.
* Verwendung von SSH als sichere Alternative.

Durch diese Änderungen wird ein unautorisierter Root-Zugriff verhindert.

---

## 7) Absicherung und Behebung der Sicherheitslücke

Um die Sicherheitslücke zu schließen, wurden folgende Maßnahmen durchgeführt bzw. empfohlen:

### rlogin deaktivieren

* rlogin-Dienst stoppen und deaktivieren
* r-Services vollständig entfernen

### Vertrauensdateien entfernen

* `/etc/hosts.equiv` löschen oder leeren
* `~/.rhosts` nicht verwenden

### Root-Login verhindern

* Kein direkter Root-Login über das Netzwerk
* Nutzung von `sudo` für administrative Aufgaben

### Sichere Alternative verwenden

* Einsatz von **SSH**
* Verschlüsselte Kommunikation
* Schlüssel- oder Passwort-Authentifizierung

---

## 8) Fazit

Diese Übung zeigt anschaulich, wie gefährlich veraltete Dienste und falsche Konfigurationen sein können.

Durch rlogin ist es möglich:

* ohne Passwort
* ohne Verschlüsselung
* direkt Root-Zugriff

auf ein System zu erlangen.

Metasploitable demonstriert damit, warum rlogin und ähnliche Dienste in modernen IT-Umgebungen **nicht mehr eingesetzt werden dürfen** und durch sichere Alternativen wie SSH ersetzt werden müssen.
